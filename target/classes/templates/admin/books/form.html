<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${book.id != null ? 'Ch·ªânh s·ª≠a s√°ch' : 'Th√™m s√°ch m·ªõi'}">S√°ch</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
<div th:replace="fragments/header :: header"></div>

<div class="container">
    <div class="page-header">
        <h1 th:text="${book.id != null ? 'Ch·ªânh s·ª≠a s√°ch' : 'Th√™m s√°ch m·ªõi'}">S√°ch</h1>
        <a th:href="@{/admin/books}" class="btn btn-secondary">‚Üê Quay l·∫°i danh s√°ch</a>
    </div>

    <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>
    <div th:if="${error}" class="alert alert-error" th:text="${error}"></div>

    <form th:action="@{/admin/books}" th:object="${book}" method="post">
        <input type="hidden" th:if="${book.id != null}" th:field="*{id}"/>

        <div class="form-group">
            <label for="title">T√™n s√°ch</label>
            <input type="text" id="title" name="title" th:field="*{title}" required>
        </div>

        <div class="form-group">
            <label for="description">M√¥ t·∫£ s√°ch</label>
            <textarea id="description" name="description" th:field="*{description}"></textarea>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="publicationYear">NƒÉm xu·∫•t b·∫£n</label>
                <input type="number" id="publicationYear" name="publicationYear" th:field="*{publicationYear}" required>
            </div>
            <div class="form-group">
                <label for="edition">L·∫ßn t√°i b·∫£n</label>
                <input type="number" id="edition" name="edition" th:field="*{edition}" required>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="condition">T√¨nh tr·∫°ng s√°ch</label>
                <select id="condition" name="condition" th:field="*{condition}">
                    <option th:each="cond : ${conditions}" th:value="${cond}" th:text="${cond.displayName}"></option>
                </select>
            </div>

            <div class="form-group">
                <label for="canBorrow">C√≥ th·ªÉ cho m∆∞·ª£n</label>
                <select id="canBorrow" name="canBorrow" th:field="*{canBorrow}">
                    <option value="true" th:selected="${book.canBorrow == true}">C√≥</option>
                    <option value="false" th:selected="${book.canBorrow == false}">Kh√¥ng</option>
                </select>
            </div>
        </div>

        <div class="form-group">
            <label for="bookshelfId">T·ªß s√°ch</label>
            <select id="bookshelfId" name="bookshelfId" required>
                <option th:each="shelf : ${bookshelves}"
                        th:value="${shelf.id}"
                        th:text="|${shelf.code} (T·∫ßng ${shelf.floor} - Khu ${shelf.section})|"
                        th:selected="${book.bookshelf?.id == shelf.id}">
                </option>
            </select>
        </div>

        <div class="form-group">
            <label for="authorIds">T√°c gi·∫£</label>
            <select id="authorIds" name="authorIds" multiple size="5" required>
                <option th:each="author : ${authors}"
                        th:value="${author.id}"
                        th:text="${author.fullName}"
                        th:selected="${book.authors.contains(author)}"></option>
            </select>
        </div>

        <div class="form-group">
            <label for="genreIds">Th·ªÉ lo·∫°i</label>
            <select id="genreIds" name="genreIds" multiple size="5" required>
                <option th:each="genre : ${genres}"
                        th:value="${genre.id}"
                        th:text="${genre.name}"
                        th:selected="${book.genres.contains(genre)}"></option>
            </select>
        </div>

        <button type="submit" class="btn btn-success">
            <i class="icon">üíæ</i> <span th:text="${book.id != null ? 'C·∫≠p nh·∫≠t' : 'L∆∞u'}"></span>
        </button>
    </form>
</div>
</body>
</html>